\begin{problem}
  In class, we talked about finite-difference approximation
  to the derivative of the univariate function $f(x)$.
  Using Taylor polynomial approximations of $f(x + h)$ and $f(x - h)$,
  we can easily show that \[ f'(x) = \frac{f(x + h) - f(x - h)}{2h} + O(h^2), \]
  so that the derivative can be approximated by convolving
  a discrete version of $f(x)$ --- a vector of values
  $(\ldots,\ f(x_{o} - \Delta), f(x_{o}), f(x_{o}+ \Delta), \ldots)$
  with kernel (1/2, 0, -1/2).
  This is termed a central difference because its interval is symmetric about a sample point.

  \begin{enumroman}
    \item Derive a higher order central-difference approximation
      to $f'(x)$ such that the truncation error tends to zero
      as $h^4$ instead of $h^2$.
      \emph{Hint} : consider Taylor polynomial approximations of $f(x \pm 2h)$
        in addition to $f(x \pm h)$. (7 points)

      \begin{Answer}
        Let $c_i$ denote the coefficient for each term containing $h^i$ in the
        full Taylor polynomial expansion, then we may  write the current estimation of
        $f'(x)$ as
        \begin{align}
          f'(x) = \frac{f(x+h) - f(x-h)}{2h} - \left[ c_2 h^2 + c_4 h^4 + c_6 h^6 + \ldots \right].~\label{eq:1}
        \end{align}
        \\
        Our goal is to eliminate the $h^2$ term.
        Consider the approximations using $f(x \pm 2h)$ by plugging $2h$ into the formula:
        \begin{align}
          f'(x) = \frac{f(x+2h) - f(x-2h)}{4h} - \left[ 4c_2 h^2 + 16 c_4 h^4 + 64 c_6h^6 + \ldots \right]~\label{eq:2}
        \end{align}
        \\
        We notice that the $h^2$ term in \ref{eq:2} is $4$ times larger than the $h^2$ term in \ref{eq:1}.
        We can eliminate the $h^2$ term in $f'(x)$ by subtracting \ref{eq:2} from $4$ times \ref{eq:1}:
        \begin{align}
          3f'(x) &= 4 \parens{\frac{f(x+h) - f(x-h)}{2h}} - \frac{f(x+2h) - f(x-2h)}{4h} - \left[ (4h^2 - 4h^2) + O(h^4) \right] \nonumber \\
          3f'(x) &= \frac{\crim{8\parens{f(x+h) - f(x-h)}} - \zaff{\parens{f(x+2h) - f(x-2h)}}}{4h} + O(h^4 \nonumber) \\
          3f'(x) &= \frac{-f(x+2h) + 8f(x+h) -8f(x-h) + f(x-2h)}{4h} + O(h^4 \nonumber) \\
          f'(x) &= \frac{-f(x+2h) + 8f(x+h) -8f(x-h) + f(x-2h)}{12h} + O(h^4) ~\label{eq:3}
        \end{align}
        We get equation ~\ref{eq:3} as a Taylor approximation of $f'(x)$ with a truncation error
        of $\calO(h^4)$.  
      \end{Answer}
    \newpage
    \item What is the corresponding convolution (not correlation!) kernel? (3 points)
    \begin{Answer}
      The approximation has a correlation kernel of
      \[
        \begin{bmatrix}
          -\frac{1}{12}, & \frac{8}{12}, & -\frac{8}{12}, & \frac{1}{12}
        \end{bmatrix}.
      \]
      The convolution kernel is the same as the correlation kernel, but flipped:
      \[
        \begin{bmatrix}
          \frac{1}{12}, & -\frac{8}{12}, & \frac{8}{12}, & -\frac{1}{12}
        \end{bmatrix}.  
      \]
    \end{Answer}
  \end{enumroman}
\end{problem}
